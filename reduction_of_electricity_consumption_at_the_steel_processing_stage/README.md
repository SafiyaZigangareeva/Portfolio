#  Уменьшение потребления электроэнергии на этапе обработки стали

## Описание проекта и цель

Чтобы оптимизировать производственные расходы, металлургический комбинат решил уменьшить потребление электроэнергии на этапе обработки стали. Предстоит построить модель, которая предскажет температуру стали.
Метрика для подбора модели - МАЕ, должна быть не более 6.8.

## Описание данных

Данные состоят из файлов, полученных из разных источников:

 - data_arc.csv — данные об электродах;
 - data_bulk.csv — данные о подаче сыпучих материалов (объём);
 - data_bulk_time.csv — данные о подаче сыпучих материалов (время);
 - data_gas.csv — данные о продувке сплава газом;
 - data_temp.csv — результаты измерения температуры;
 - data_wire.csv — данные о проволочных материалах (объём);
 - data_wire_time.csv — данные о проволочных материалах (время).

Во всех файлах столбец key содержит номер партии. В файлах может быть несколько строк с одинаковым значением key: они соответствуют разным итерациям обработки.

## План работы

1. Подготовка данных:
 - Открыть файлы и изучить их.
 - Посмотреть какие данные можно использовать для обучения модели, произвести предобработку данных (пропуски, аномалии).
 - Добавить новые признаки, которые помогут в обучении модели (Feature Engineering).
2. Объединить датасеты в один. Произвести EDA анализ полученных данных.
 - Объединение датафреймов
 - Разбиение датафрейма на выборки и анализ данных
 - Проверка мультиколлинеарности признаков и корреляции с таргетом.
 - Отбор признаков (Feature Selection)
 - Выбор моделей для обучения (2-3 модели).
3. Подбор и обучение моделей:
 - Проверка метрики на тесте константной модели.
 - Подбор лучших гиперапараметров моделей на кросс-валидации.
 - Проверка лучшей модели на тестовой выборке.
 - Определить какие признаки модель посчитала самыми важными для прогноза.
4. Выводы - отчет.

## Выводы
По результатам анализа датасета было решено использовать для обучения и подбора гиперпараметров следующие модели: 
 - Ridge, 
 - Lasso, 
 - LGBMRegressor.

Подбор лучших гиперпараметров осуществлялся при помощи GridSearchCV. :Для уменьшения размерности признакового пространства использовался метод главных компонент - PCA.

Лучшая модель - Lasso, MAE для best_estimator_ составляет 5.46 на кросс-валидации.
Лучшая модель была проверена на тестовой выборке, ее результат составляет 5.63

Были определены самые важные признаки по мнению лучшей модели, это:
 - Количество добавлений Bulk - признак, построенный на основании данных о времени добавления сыпучих добавок.
 - Wire 7 - объем проволочной добавки №7.
 - Количество добавлений Wire - признак, построенный на основании данных о времени добавления проволочных добавок.

На будущее можно попробовать применять PCA только к мультиколлинеарным признакам, а для отбора и ранжирования признаков воспользоваться методом рекурсивного исключения признаков (recursive feature elimination).