#  Прототип рекомендательного сервиса рецептов

## Описание проекта и цель

Создание консольного приложения - прототипа рекомендательного сервиса рецептов. 
Которое осуществляет прогноз рейтинга блюда из заданных ингридиентов, вывод питательных веществ в проценте от суточной нормы, трех рецептов с минимальным количеством дополнительных продуктов, вывод случайного "Меню дня" из рецептов с наивысшими оценками.

## Описание данных

 - датасет из Epicurious, подготовленный HugoDarwood

## План работы

 1. Написание скрипта `nutritionist.py`, который:
 - принимает на вход список ингредиентов
 - создает прогноз и выдает рейтинг с оценкой (`невкусное`, `нормальное`, `вкусное`) блюда, которое можно приготовить на основе списка переданных ингредиентов.
 - находит и выводит информацию обо всех питательных веществах (белках, жирах, натрии и т. д.) продуктов из списка, а также их объем в процентах от суточной нормы потребления.
 - отображает три рецепта блюд, в которых используется максимальное количество продуктов из списка, с указанием их оценки и ссылок, по которым пользователь сможет найти полную информацию.
 2. Исследование - `recipes.ipynb`:
 - Подготовка данных
 - Прогноз рейтинга с помощью регрессионных алгоритмов и их ансамблей (), метрика RMSE
 - Бинаризация целевой переменной в классы `bad` (0, 1) (невкусное), `so-so` (2, 3) (нормальное), `great` (4, 5) (вкусное). 
 - Алгоритмы классификации и подбор метрики для решения задачи прогноза.
 - Определение метрики на тестовой выборке.
 - Сохранение лучшей модели.
 3. Пищевая ценность и похожие рецепты:
 - Сбор в датафрейм информации о пищевой ценности продуктов из `FoodData Central API`
 - Сбор в датафрейм для каждого рецепта из набора данных ссылки на сайт epicurious.com и подробную информацию о нем (название рецепта, рейтинг на платформе и URl). 


## Выводы

Исходный датасет содержал 20052 рецептов и 680 признаков (ингридиенты). Из датасета удалены дубликаты и признаки, которые не относятся к ингридиентам.

Машинное обучение - регерессия:
 - RMSE наивного регрессора: 1.32
 - Лучшие результаты показал ансамбль StackingRegressor, RMSE на test - 1.24, что немного лучше наивного регрессора.

Машинное обучение - классификация:
 - После бинаризации целевой переменной в классы bad (0, 1) (невкусное), so-so (2, 3) (нормальное), great (4, 5) (вкусное):
   
   Accuracy наивного классификатора: 0.79

   Лучшая модель SVC, accuracy на test - 0.80
 - Изменение метрики на precision_score, average="weighted":

   Лучшая модель - GradientBoostingClassifier с precision 0.74 - будет использоваться далее.


Что можно улучшить:
 - улучшить прогноз за счет корректировки дисбаланса классов
 - оформление консольного приложения в виде telegram bot
 - дополнительный функционал (составление меню на день).


## Навыки и инструменты:

 - `Pandas`, `NumPy`, `Matplotlib`, `BeautifulSoup`, `requests`, `Scikit-learn`
 - StackingRegressor, GradientBoostingRegressor, GradientBoostingClassifier, StackingClassifier, make_scorer
 - BeautifulSoup, requests

